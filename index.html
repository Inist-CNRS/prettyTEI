<!DOCTYPE html>
<html>
    <head>
        <title>Pretty TEI demo</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="dist/css/bootstrap-theme.min.css">
        <link rel="stylesheet" href="css/tei.css">
        <style>
        body{
            background: #DBDADB;
        }
        h1{
            text-align: center;
            margin-bottom: 50px; 
        }
            #uploadDiv{
                text-align: center;
            }
            #dropArea {
                display: flex;
                justify-content:center;
                align-items: center;
              border: 10px dashed;
              border-radius: 10px;
              border-color: gray;
              width: 200px;
              height: 200px;
              margin: 0 auto;
              transition :  all 450ms;
              font-size: 12px;
            }
            #dropArea:hover {
              transform : scale(1.06);
              border-color: #555;
            }
            .hover {
              transform : scale(1.06);
              border-color: #555 !important;
            }
            .pictures{
                max-width: 100%;
                height: auto;
                box-shadow: 0px 0px 19px #555;
            }
            #listDiv{
                margin-top: 150px; 
            }
            .figurex:hover{
                cursor: pointer;
            }
            .figurex:hover > .pictures{
                box-shadow: 0px 0px 19px #000;
            }

            .figurex figcaption{
                text-align: center;
                color: #555;
                background: #fff;
            }
            .modal-dialog{
                z-index: 9999;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <h1 class="col-lg-12">Drag & Drop your TEI files to watch them with prettyTEI:</h1>
            <div class="row">
                <div class="col-sm-2"></div>

                <section id="uploadDiv" class="col-sm-8">
                    <div id="dropArea" draggable='true'>Drag & drop files here</div>
                </section>

                <section id="listDiv" class="col-sm-12">
                </section>
            </div>
        </div>
        <script src="dist/js/jquery-11.1.2.js"></script>
        <script src="dist/js/bootstrap.min.js"></script>
        <script>

            var dropArea = $('#dropArea'),
                listDiv = $("#listDiv"),
                nbOfFiles = 0;


            dropArea.bind({
              // Effect on dragover
              dragover: function() {
                $(this).addClass('hover');
                return false;
              },
              // Remove Class on dragleave
              dragleave: function() {
                $(this).removeClass('hover');
                return false;
              },
              //Function when drop file(s)
              drop: function(e) {
                $(this).removeClass('hover');
                e = e || window.event;
                e.preventDefault();

                e = e.originalEvent || e;
           
                var files = (e.files || e.dataTransfer.files);

                for (var i = 0; i < files.length; i++) {
                  (function(i) {
                    // Loop through files with a closure so every FileReader are isolated.
                    var reader = new FileReader();
                    reader.onload = function(event) { 
                            // get file content , name  
                            var name = files[i].name;
                            var text = event.target.result; 
                            var figure = $('<figure class="figurex col-sm-3"></figure>');
                            var div = '<div class="modal fade" id="figcaption'+ nbOfFiles +'" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\
                              <div class="modal-dialog">\
                                <div class="modal-content">\
                                  <div class="modal-header">\
                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\
                                    <h4 class="modal-title" id="myModalLabel">'+ name +'</h4>\
                                  </div>\
                                  <div class="modal-body tei">\
                                    '+ text +'\
                                  </div>\
                                  <div class="modal-footer">\
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\
                                  </div>\
                                </div>\
                              </div>\
                            </div>';
                            console.log("name : " , name);
                            console.log("text : " , text);
                            var li = document.createElement("li");
                            li.innerHTML = name + "____" + text;
                            figure.append('<img src="dist/img/xml.jpg" class="pictures" alt="xml picture" data-toggle="modal" data-target="#figcaption'+ nbOfFiles +'">','<figcaption>'+ name +'</figcaption>');
                            listDiv.append(figure);
                            listDiv.append(div)

                        }
                        reader.readAsText(files[i], "UTF-8");
                        nbOfFiles++;
                    })(i);
                }
            }
        });
                         //$(".js-tei").append("<div class='tei'></div>").children("div.tei").load("tei/test.xml");
        </script>
    </body>
</html>
